var u=["a","abbr","address","article","aside","b","body","blockquote","button","canvas","cite","code","colgroup","data","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","i","iframe","img","input","ins","kbd","label","legend","li","main","map","mark","menu","menuitem","meter","nav","object","ol","optgroup","option","output","p","pre","progress","q","section","select","small","span","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","u","ul","var","video","details","datalist"],d=["audio","base","br","col","embed","link","meta","noscript","source","track","wbr","area","command","picture","progress","html","head"],h=["title","template"],c=(r,e,o)=>(...t)=>{let n={},a=[];return e&&t.length>0&&typeof t[0]=="object"?(n=t[0],o&&t.length>1&&(a=t.slice(1))):o&&t.length>0&&(a=t),()=>({tag:r,getOptions:n?()=>{let s={};for(let i of Object.keys(n)){let l=n[i];if(typeof l!="function"){s[i]=l;continue}if(i.startsWith("on")){s[i]=l;continue}s[i]=l()}return s}:()=>({}),children:a})};globalThis._e={...u.reduce((r,e)=>(r[e]=c(e,!0,!0),r),{}),...h.reduce((r,e)=>(r[e]=c(e,!1,!0),r),{}),...d.reduce((r,e)=>(r[e]=c(e,!0,!1),r),{})};var g=class{constructor(){this.stateController=globalThis.eleganceStateController;this.renderer=globalThis.eleganceRenderer;console.log("%cElegance router is loading..","font-size: 30px; color: #aaffaa"),this.savedPages=new Map,this.onNavigateCallbacks=[],this.currentPage=window.location.pathname}log(e){console.log(`%c${e}`,"font-size: 15px; color: #aaffaa")}sleep(e){return new Promise(o=>setTimeout(o,e))}async navigate(e,o=!0){if(!e.startsWith("/"))throw new Error("Elegance router can only navigate to local pages.");this.log("Calling onNavigateCallbacks..");for(let n of this.onNavigateCallbacks)n();this.onNavigateCallbacks=[],this.log("Performing state cleanup.."),this.stateController.resetEphemeralSubjects(),this.stateController.cleanSubjectObservers(),this.log(`Navigating to page: ${e}`);let t=this.savedPages.get(e)??await this.getPage(e);if(!t)throw new Error("Failed to fetch page.");o&&history.pushState(null,"",e),this.currentPage=e,this.renderer.renderPage(t)}async getPage(e){if(this.savedPages.has(e))return;if(!e.startsWith("/"))throw new Error("Elegance router can only fetch local pages.");this.log(`Fetching URL: ${e}`);let o=e==="/"?"":"/",t=await fetch(e);if(!t.ok)throw`Could not load page at ${e}, received HTTP response status ${t.status}. ${t.statusText}`;let n=await t.text(),s=new DOMParser().parseFromString(n,"text/html");try{let{page:i}=await import(e+o+"page.js");if(!i)throw new Error(`Page at ${e} could not be loaded.`);return this.addPage(e,i),i}catch(i){this.log(`Could not load the page at ${e}: ${i}`);return}}addPage(e,o){this.log(`Saving page with pathname: ${e}`),this.savedPages.set(e,o)}async prefetch(e){await this.getPage(e)}onNavigate(e){this.log("Adding onNavigateCallback."),this.onNavigateCallbacks.push(e)}setPopState(){window.onpopstate=e=>{e.preventDefault();let o=window.location.origin,t=e.target;if(t.origin!==o||this.currentPage===t.location.pathname)return;let a=window.location.href.replace(window.location.origin,"");this.navigate(a,!1)}}};(async()=>{let r=n=>({renderingMethod:n.rm,storedEventListeners:n.sels?.map(a=>({eleganceID:a.id,eventListeners:a.els.map(s=>({attributeName:s.an,eventListener:s.el}))}))}),e=globalThis.__ELEGANCE_PAGE_INFO__;throw e?r(e).renderingMethod!==2?"The STATIC_GENERATION client may only be used if the page has been rendered via the STATIC_GENERATION renderingMethod.":"STATIC_GENERATION renderingMethod not implemented yet.":(alert("Misconfigured Elegance.JS server, check console."),"globalThis.__ELEGANCE_PAGE_INFO__ is not set, is corrupted, or is set inproperly. Make sure your server configuration sets a <script> with this variable.")})();
